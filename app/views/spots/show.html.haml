.max-width-4.mx-auto
  .clearfix
    .col.col-12.sm-col.sm-col-6.p2
      %h1.orange= @spot.name
      %h2= @spot.address
      %p= @spot.description
    .col.col-12.sm-col.sm-col-6.p2
      #map{style: "width: 100%; height: 512px;"}
    .col.col-12
      %h1 Featured media
      - if user_signed_in?
        = link_to 'Upload media', new_spot_medium_path(@spot.id), class: 'orange text-decoration-none'
      .clearfix 
        - @media.each do |medium|
          .col.col-3
            = image_tag "http://#{medium.s3_path}", class: 'fit', style: 'max-height: 150px;'


= content_for(:after_js) do
  = javascript_tag do 
    $(document).ready(function() {
    var handler = Gmaps.build('Google');
    handler.buildMap({ internal: { id: 'map' } }, function() {
    markers = handler.addMarkers(#{raw @hash.to_json});
    handler.bounds.extendWith(markers);
    handler.fitMapToBounds();
    if (markers.length == 0) {
    handler.getMap().setZoom(2);
    } else if (markers.length == 1) {
    handler.getMap().setZoom(14);
    }
    });
    });
